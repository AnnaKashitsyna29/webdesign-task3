<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pixel Jumper - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        color: white;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .game-container {
        background: rgba(25, 25, 35, 0.9);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        border: 2px solid #3498db;
        max-width: 900px;
        width: 100%;
      }

      h1 {
        text-align: center;
        color: #3498db;
        margin-bottom: 10px;
        font-size: 2.5em;
      }

      .subtitle {
        text-align: center;
        color: #95a5a6;
        margin-bottom: 20px;
      }

      canvas {
        background: #0c141c;
        border-radius: 10px;
        border: 3px solid #2ecc71;
        display: block;
        margin: 0 auto 20px;
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
      }

      button {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 1em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: 120px;
        justify-content: center;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .btn-start {
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
      }

      .btn-pause {
        background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        color: white;
      }

      .btn-restart {
        background: linear-gradient(135deg, #e67e22, #d35400);
        color: white;
      }

      .ui-overlay {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        padding: 0 10px;
      }

      .ui-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 1.2em;
        font-weight: bold;
      }

      .score {
        color: #f1c40f;
      }
      .lives {
        color: #e74c3c;
      }
      .level {
        color: #2ecc71;
      }

      .screen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: none;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        z-index: 10;
      }

      .screen.active {
        display: flex;
      }

      .screen-content {
        background: #2c3e50;
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        border: 3px solid #3498db;
        max-width: 500px;
        width: 90%;
      }

      .screen h2 {
        color: #3498db;
        margin-bottom: 20px;
        font-size: 2em;
      }

      .screen p {
        margin-bottom: 20px;
        font-size: 1.2em;
      }

      .controls-info {
        background: rgba(44, 62, 80, 0.8);
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
        border: 2px solid #3498db;
      }

      .controls-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-top: 15px;
      }

      .control-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 5px;
        padding: 10px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 8px;
      }

      .control-item kbd {
        background: #34495e;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-family: monospace;
        font-size: 1.1em;
        min-width: 40px;
        text-align: center;
      }

      footer {
        text-align: center;
        margin-top: 20px;
        color: #95a5a6;
        font-size: 0.9em;
      }

      .coins-display {
        color: #f1c40f;
        font-size: 1.3em;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <div class="game-container">
      <h1>Pixel Jumper</h1>
      <p class="subtitle">Legendary 2D Platformer, sdelano Kashitsynoy Entertainment</p>

      <div class="ui-overlay">
        <div class="ui-item score">
          <span>üèÜ</span>
          <span id="score">0</span>
        </div>
        <div class="ui-item lives">
          <span>‚ù§Ô∏è</span>
          <span id="lives">3</span>
        </div>
        <div class="ui-item level">
          <span>üéØ</span>
          <span id="level">1/3</span>
        </div>
        <div class="ui-item coins-display">
          <span>üí∞</span>
          <span id="coinsDisplay">0/0</span>
        </div>
      </div>

      <canvas id="gameCanvas" width="800" height="450"></canvas>

      <div class="controls">
        <button id="startBtn" class="btn-start"><span>‚ñ∂Ô∏è</span> –°—Ç–∞—Ä—Ç</button>
        <button id="pauseBtn" class="btn-pause"><span>‚è∏Ô∏è</span> –ü–∞—É–∑–∞</button>
        <button id="restartBtn" class="btn-restart">
          <span>üîÑ</span> –†–µ—Å—Ç–∞—Ä—Ç
        </button>
      </div>

      <!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ä—Ç–∞ -->
      <div id="startScreen" class="screen active">
        <div class="screen-content">
          <h2>Pixel Jumper</h2>
          <p>–°–æ–±–µ—Ä–∏ –≤—Å–µ –º–æ–Ω–µ—Ç—ã –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ!</p>
          <button
            id="playBtn"
            class="btn-start"
            style="margin: 20px 0; padding: 15px 30px; font-size: 1.2em"
          >
            <span>‚ñ∂Ô∏è</span> –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
          </button>
          <div class="controls-info">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</h3>
            <div class="controls-grid">
              <div class="control-item">
                <kbd>A</kbd>
                <kbd>D</kbd>
                <span>–î–≤–∏–∂–µ–Ω–∏–µ</span>
              </div>
              <div class="control-item">
                <kbd>W</kbd>
                <kbd>Space</kbd>
                <span>–ü—Ä—ã–∂–æ–∫</span>
              </div>
              <div class="control-item">
                <kbd>P</kbd>
                <span>–ü–∞—É–∑–∞</span>
              </div>
              <div class="control-item">
                <kbd>R</kbd>
                <span>–†–µ—Å—Ç–∞—Ä—Ç</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω –ø–∞—É–∑—ã -->
      <div id="pauseScreen" class="screen">
        <div class="screen-content">
          <h2>‚è∏Ô∏è –ü–∞—É–∑–∞</h2>
          <p>–ò–≥—Ä–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞</p>
          <button id="resumeBtn" class="btn-start" style="margin-top: 20px">
            <span>‚ñ∂Ô∏è</span> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
          </button>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω Game Over -->
      <div id="gameOverScreen" class="screen">
        <div class="screen-content">
          <h2>üíÄ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
          <p>–í–∞—à —Å—á–µ—Ç: <span id="finalScore">0</span></p>
          <p>–£—Ä–æ–≤–µ–Ω—å: <span id="finalLevel">1</span></p>
          <button
            id="restartAfterGameOverBtn"
            class="btn-start"
            style="margin-top: 20px"
          >
            <span>üîÑ</span> –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞
          </button>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è -->
      <div id="levelCompleteScreen" class="screen">
        <div class="screen-content" style="background: rgba(46, 204, 113, 0.9)">
          <h2>üèÜ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</h2>
          <p>
            –ú–æ–Ω–µ—Ç—ã: <span id="coinsCollected">0</span>/<span id="totalCoins"
              >0</span
            >
          </p>
          <p>–ë–æ–Ω—É—Å: <span id="bonusPoints">0</span> –æ—á–∫–æ–≤</p>
          <button id="nextLevelBtn" class="btn-start" style="margin-top: 20px">
            <span>‚û°Ô∏è</span> –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
          </button>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã -->
      <div id="victoryScreen" class="screen">
        <div class="screen-content" style="background: rgba(241, 196, 15, 0.9)">
          <h2>üëë –ü–æ–±–µ–¥–∞!</h2>
          <p>–í—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ 3 —É—Ä–æ–≤–Ω—è!</p>
          <p>–§–∏–Ω–∞–ª—å–Ω—ã–π —Å—á–µ—Ç: <span id="victoryScore">0</span></p>
          <button id="playAgainBtn" class="btn-start" style="margin-top: 20px">
            <span>üîÑ</span> –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞
          </button>
        </div>
      </div>

      <footer>
        Pixel Jumper ¬© 2024 | –í—Å–µ –º–æ–Ω–µ—Ç—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞
      </footer>
    </div>

    <script>
      // –ü—Ä–æ—Å—Ç–∞—è –∏–≥—Ä–∞ —Å —É—Ä–æ–≤–Ω—è–º–∏ - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø
      class SimpleGame {
        constructor() {
          this.canvas = document.getElementById("gameCanvas");
          this.ctx = this.canvas.getContext("2d");
          this.state = "menu"; // menu, playing, paused, gameOver, levelComplete, victory
          this.score = 0;
          this.lives = 3;
          this.currentLevel = 1;
          this.totalLevels = 3;
          this.coinsCollected = 0;
          this.totalCoins = 0;

          // –•—Ä–∞–Ω–∏–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
          this.levelData = this.createLevelData();

          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
          this.loadCurrentLevel();
          this.setupInput();
          this.setupUI();
          this.updateUI();

          console.log("–ò–≥—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞");
        }

        createLevelData() {
          return [
            {
              // –£—Ä–æ–≤–µ–Ω—å 1
              id: 1,
              name: "–û–±—É—á–µ–Ω–∏–µ",
              platforms: [
                { x: 50, y: 350, width: 200, height: 20 },
                { x: 300, y: 300, width: 150, height: 20 },
                { x: 500, y: 250, width: 150, height: 20 },
                { x: 700, y: 200, width: 150, height: 20 },
                { x: 600, y: 150, width: 100, height: 20 },
                { x: 400, y: 100, width: 100, height: 20 },
              ],
              coins: [
                { x: 150, y: 290 },
                { x: 350, y: 240 },
                { x: 550, y: 190 },
                { x: 750, y: 140 },
                { x: 650, y: 90 },
                { x: 450, y: 40 },
              ],
              startX: 100,
              startY: 250,
              finishX: 750,
              finishY: 140,
            },
            {
              // –£—Ä–æ–≤–µ–Ω—å 2
              id: 2,
              name: "–°–ª–æ–∂–Ω–µ–µ",
              platforms: [
                { x: 50, y: 350, width: 150, height: 20 },
                { x: 250, y: 300, width: 100, height: 20 },
                { x: 400, y: 250, width: 100, height: 20 },
                { x: 550, y: 300, width: 100, height: 20 },
                { x: 700, y: 250, width: 150, height: 20 },
                { x: 600, y: 200, width: 80, height: 20 },
                { x: 450, y: 150, width: 80, height: 20 },
                { x: 300, y: 100, width: 80, height: 20 },
              ],
              coins: [
                { x: 125, y: 290 },
                { x: 300, y: 240 },
                { x: 450, y: 190 },
                { x: 600, y: 240 },
                { x: 775, y: 190 },
                { x: 640, y: 140 },
                { x: 490, y: 90 },
                { x: 340, y: 40 },
              ],
              startX: 100,
              startY: 280,
              finishX: 340,
              finishY: 40,
            },
            {
              // –£—Ä–æ–≤–µ–Ω—å 3
              id: 3,
              name: "–≠–∫—Å–ø–µ—Ä—Ç",
              platforms: [
                { x: 50, y: 350, width: 120, height: 20 },
                { x: 220, y: 320, width: 100, height: 20 },
                { x: 370, y: 350, width: 100, height: 20 },
                { x: 520, y: 320, width: 100, height: 20 },
                { x: 670, y: 350, width: 120, height: 20 },
                { x: 600, y: 280, width: 80, height: 20 },
                { x: 450, y: 250, width: 80, height: 20 },
                { x: 300, y: 220, width: 80, height: 20 },
                { x: 150, y: 250, width: 80, height: 20 },
                { x: 50, y: 180, width: 80, height: 20 },
                { x: 200, y: 150, width: 100, height: 20 },
                { x: 400, y: 120, width: 100, height: 20 },
                { x: 600, y: 90, width: 100, height: 20 },
              ],
              coins: [
                { x: 110, y: 290 },
                { x: 270, y: 260 },
                { x: 420, y: 290 },
                { x: 570, y: 260 },
                { x: 730, y: 290 },
                { x: 640, y: 220 },
                { x: 490, y: 190 },
                { x: 340, y: 160 },
                { x: 190, y: 190 },
                { x: 90, y: 120 },
                { x: 250, y: 90 },
                { x: 450, y: 60 },
                { x: 650, y: 30 },
              ],
              startX: 100,
              startY: 280,
              finishX: 650,
              finishY: 30,
            },
          ];
        }

        loadCurrentLevel() {
          const level = this.levelData[this.currentLevel - 1];
          console.log(`–ó–∞–≥—Ä—É–∂–∞–µ–º —É—Ä–æ–≤–µ–Ω—å ${this.currentLevel}: ${level.name}`);

          // –°–æ–∑–¥–∞–µ–º —Å–≤–µ–∂–∏–µ –º–æ–Ω–µ—Ç—ã –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
          this.coins = level.coins.map((coin) => ({
            x: coin.x,
            y: coin.y,
            collected: false,
          }));

          this.totalCoins = this.coins.length;
          this.coinsCollected = 0;

          // –ò–≥—Ä–æ–∫
          this.player = {
            x: level.startX,
            y: level.startY,
            width: 32,
            height: 64,
            vx: 0,
            vy: 0,
            onGround: false,
            facingRight: true,
            canJump: true,
          };

          // –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã –∏ —Ñ–∏–Ω–∏—à
          this.platforms = level.platforms;
          this.finish = {
            x: level.finishX,
            y: level.finishY,
            width: 30,
            height: 50,
          };

          this.updateUI();
        }

        setupInput() {
          // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
          document.addEventListener("keydown", (e) => {
            const key = e.key.toLowerCase();
            this.keys[key] = true;

            if (e.key === " ") e.preventDefault();
            if (key === "p") this.togglePause();
            if (key === "r") this.restart();
          });

          document.addEventListener("keyup", (e) => {
            const key = e.key.toLowerCase();
            this.keys[key] = false;

            // –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä—ã–∂–æ–∫ —Å–Ω–æ–≤–∞ –∫–æ–≥–¥–∞ –æ—Ç–ø—É—Å–∫–∞–µ–º –∫–ª–∞–≤–∏—à—É
            if (key === "w" || key === " " || key === "arrowup") {
              if (this.player) this.player.canJump = true;
            }
          });

          this.keys = {};
        }

        setupUI() {
          // –ö–Ω–æ–ø–∫–∏
          const addClickListener = (id, handler) => {
            const element = document.getElementById(id);
            if (element) {
              element.addEventListener("click", handler.bind(this));
            }
          };

          addClickListener("playBtn", () => this.start());
          addClickListener("startBtn", () => this.start());
          addClickListener("pauseBtn", () => this.togglePause());
          addClickListener("resumeBtn", () => this.togglePause());
          addClickListener("restartBtn", () => this.restart());
          addClickListener("restartAfterGameOverBtn", () => this.restart());
          addClickListener("nextLevelBtn", () => this.nextLevel());
          addClickListener("playAgainBtn", () => this.restart());

          // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –∫—Ä–æ–º–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ
          this.hideAllScreens();
          this.showScreen("startScreen");
        }

        showScreen(screenId) {
          this.hideAllScreens();
          const screen = document.getElementById(screenId);
          if (screen) {
            screen.classList.add("active");
          }
        }

        hideAllScreens() {
          const screens = document.querySelectorAll(".screen");
          screens.forEach((screen) => screen.classList.remove("active"));
        }

        updateUI() {
          document.getElementById("score").textContent = this.score;
          document.getElementById("lives").textContent = this.lives;
          document.getElementById(
            "level"
          ).textContent = `${this.currentLevel}/${this.totalLevels}`;
          document.getElementById(
            "coinsDisplay"
          ).textContent = `${this.coinsCollected}/${this.totalCoins}`;
          document.getElementById("finalScore").textContent = this.score;
          document.getElementById("finalLevel").textContent = this.currentLevel;
          document.getElementById("coinsCollected").textContent =
            this.coinsCollected;
          document.getElementById("totalCoins").textContent = this.totalCoins;
          document.getElementById("bonusPoints").textContent =
            this.coinsCollected * 20;
          document.getElementById("victoryScore").textContent = this.score;
        }

        start() {
          if (this.state === "playing") return;

          this.state = "playing";
          this.running = true;
          this.lastTime = performance.now();
          this.showScreen("");

          // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
          this.gameLoop();

          console.log("–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å");
        }

        togglePause() {
          if (this.state === "playing") {
            this.state = "paused";
            this.showScreen("pauseScreen");
          } else if (this.state === "paused") {
            this.state = "playing";
            this.showScreen("");
            this.lastTime = performance.now();
            this.gameLoop();
          }
        }

        restart() {
          console.log("–†–µ—Å—Ç–∞—Ä—Ç –∏–≥—Ä—ã...");

          this.score = 0;
          this.lives = 3;
          this.currentLevel = 1;
          this.loadCurrentLevel();
          this.state = "menu";
          this.showScreen("startScreen");
          this.updateUI();

          console.log("–ò–≥—Ä–∞ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞");
        }

        restartLevel() {
          console.log("–†–µ—Å—Ç–∞—Ä—Ç —É—Ä–æ–≤–Ω—è...");

          this.loadCurrentLevel();
          this.state = "playing";
          this.running = true;
          this.lastTime = performance.now();
          this.showScreen("");
          this.gameLoop();
        }

        gameOver() {
          this.state = "gameOver";
          this.running = false;
          this.showScreen("gameOverScreen");
          console.log("–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞");
        }

        completeLevel() {
          this.state = "levelComplete";
          this.running = false;

          // –ë–æ–Ω—É—Å—ã
          const coinsBonus = this.coinsCollected * 20;
          const levelBonus = 100;
          this.score += coinsBonus + levelBonus;

          this.updateUI();
          this.showScreen("levelCompleteScreen");

          console.log(
            `–£—Ä–æ–≤–µ–Ω—å ${this.currentLevel} –ø—Ä–æ–π–¥–µ–Ω! –ë–æ–Ω—É—Å: ${
              coinsBonus + levelBonus
            } –æ—á–∫–æ–≤`
          );
        }

        victory() {
          this.state = "victory";
          this.running = false;

          // –§–∏–Ω–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å
          this.score += 500;

          this.updateUI();
          this.showScreen("victoryScreen");

          console.log("–í—Å–µ —É—Ä–æ–≤–Ω–∏ –ø—Ä–æ–π–¥–µ–Ω—ã! –ü–æ–±–µ–¥–∞!");
        }

        nextLevel() {
          if (this.currentLevel < this.totalLevels) {
            this.currentLevel++;
            this.loadCurrentLevel();
            this.state = "playing";
            this.running = true;
            this.lastTime = performance.now();
            this.showScreen("");
            this.gameLoop();

            console.log(`–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å ${this.currentLevel}`);
          } else {
            this.victory();
          }
        }

        gameLoop() {
          if (!this.running || this.state !== "playing") return;

          const currentTime = performance.now();
          const deltaTime = Math.min(currentTime - this.lastTime, 100) / 1000;
          this.lastTime = currentTime;

          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
          this.update(deltaTime);

          // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
          this.render();

          // –°–ª–µ–¥—É—é—â–∏–π –∫–∞–¥—Ä
          requestAnimationFrame(() => this.gameLoop());
        }

        update(deltaTime) {
          const player = this.player;

          // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
          if (this.keys["a"] || this.keys["arrowleft"]) {
            player.vx = -5;
            player.facingRight = false;
          } else if (this.keys["d"] || this.keys["arrowright"]) {
            player.vx = 5;
            player.facingRight = true;
          } else {
            player.vx *= 0.85;
            if (Math.abs(player.vx) < 0.1) player.vx = 0;
          }

          // –ü—Ä—ã–∂–æ–∫
          if (
            (this.keys["w"] || this.keys[" "] || this.keys["arrowup"]) &&
            player.onGround &&
            player.canJump
          ) {
            player.vy = -12;
            player.onGround = false;
            player.canJump = false;
          }

          // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è
          if (!player.onGround) {
            player.vy += 0.5;
            player.vy = Math.min(player.vy, 20);
          }

          // –î–≤–∏–∂–µ–Ω–∏–µ
          player.x += player.vx;
          player.y += player.vy;

          // –ì—Ä–∞–Ω–∏—Ü—ã —ç–∫—Ä–∞–Ω–∞
          if (player.x < 0) {
            player.x = 0;
            player.vx = 0;
          }
          if (player.x > this.canvas.width - player.width) {
            player.x = this.canvas.width - player.width;
            player.vx = 0;
          }

          // –ü–∞–¥–µ–Ω–∏–µ
          if (player.y > this.canvas.height) {
            this.lives--;
            if (this.lives <= 0) {
              this.gameOver();
            } else {
              // –†–µ—Å–ø–∞–≤–Ω –Ω–∞ —Ç–µ–∫—É—â–µ–º —É—Ä–æ–≤–Ω–µ
              const level = this.levelData[this.currentLevel - 1];
              player.x = level.startX;
              player.y = level.startY;
              player.vx = 0;
              player.vy = 0;
              player.onGround = false;
              player.canJump = true;
              this.updateUI();

              console.log(`–†–µ—Å–ø–∞–≤–Ω. –û—Å—Ç–∞–ª–æ—Å—å –∂–∏–∑–Ω–µ–π: ${this.lives}`);
            }
          }

          // –ö–æ–ª–ª–∏–∑–∏–∏ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
          player.onGround = false;
          for (const platform of this.platforms) {
            if (this.checkCollision(player, platform)) {
              // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–æ—Ä–æ–Ω—É –∫–æ–ª–ª–∏–∑–∏–∏
              const playerBottom = player.y + player.height;
              const platformTop = platform.y;

              // –ü–∞–¥–µ–Ω–∏–µ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —Å–≤–µ—Ä—Ö—É
              if (player.vy > 0 && playerBottom - player.vy <= platformTop) {
                player.y = platformTop - player.height;
                player.vy = 0;
                player.onGround = true;
                player.canJump = true;
              }
              // –£–¥–∞—Ä –≥–æ–ª–æ–≤–æ–π —Å–Ω–∏–∑—É
              else if (player.vy < 0) {
                player.y = platformTop + platform.height;
                player.vy = 0;
              }
              // –ë–æ–∫–æ–≤—ã–µ –∫–æ–ª–ª–∏–∑–∏–∏
              else {
                if (player.vx > 0) {
                  // –î–≤–∏–≥–∞–ª—Å—è –≤–ø—Ä–∞–≤–æ
                  player.x = platform.x - player.width;
                  player.vx = 0;
                } else if (player.vx < 0) {
                  // –î–≤–∏–≥–∞–ª—Å—è –≤–ª–µ–≤–æ
                  player.x = platform.x + platform.width;
                  player.vx = 0;
                }
              }
            }
          }

          // –°–±–æ—Ä –º–æ–Ω–µ—Ç
          let collectedNewCoins = false;
          for (let i = this.coins.length - 1; i >= 0; i--) {
            const coin = this.coins[i];
            if (!coin.collected) {
              const dx = player.x + player.width / 2 - coin.x;
              const dy = player.y + player.height / 2 - coin.y;
              const distance = Math.sqrt(dx * dx + dy * dy);

              if (distance < 30) {
                coin.collected = true;
                this.score += 10;
                this.coinsCollected++;
                collectedNewCoins = true;
              }
            }
          }

          if (collectedNewCoins) {
            this.updateUI();
          }

          // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–Ω–∏—à–∞
          if (this.checkCollision(player, this.finish)) {
            if (this.coinsCollected >= this.totalCoins) {
              this.completeLevel();
            } else {
              // –°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –º–æ–Ω–µ—Ç—ã
              const remaining = this.totalCoins - this.coinsCollected;
              console.log(`–°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ –º–æ–Ω–µ—Ç—ã! –û—Å—Ç–∞–ª–æ—Å—å: ${remaining}`);
            }
          }
        }

        checkCollision(obj1, obj2) {
          return (
            obj1.x < obj2.x + obj2.width &&
            obj1.x + obj1.width > obj2.x &&
            obj1.y < obj2.y + obj2.height &&
            obj1.y + obj1.height > obj2.y
          );
        }

        render() {
          const ctx = this.ctx;
          const player = this.player;

          // –û—á–∏—Å—Ç–∫–∞
          ctx.fillStyle = "#0c141c";
          ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

          // –§–æ–Ω
          const gradient = ctx.createLinearGradient(
            0,
            0,
            0,
            this.canvas.height
          );
          gradient.addColorStop(0, "#1a5276");
          gradient.addColorStop(1, "#0c3c5c");
          ctx.fillStyle = gradient;
          ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

          // –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã
          ctx.fillStyle = "#2ecc71";
          for (const platform of this.platforms) {
            ctx.fillRect(
              platform.x,
              platform.y,
              platform.width,
              platform.height
            );

            // –ö–æ–Ω—Ç—É—Ä
            ctx.strokeStyle = "#27ae60";
            ctx.lineWidth = 2;
            ctx.strokeRect(
              platform.x,
              platform.y,
              platform.width,
              platform.height
            );
          }

          // –ú–æ–Ω–µ—Ç—ã
          for (const coin of this.coins) {
            if (!coin.collected) {
              ctx.save();
              ctx.translate(coin.x, coin.y);

              // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
              const rotation = Date.now() / 1000;
              ctx.rotate(rotation);

              ctx.fillStyle = "#f1c40f";
              ctx.beginPath();
              ctx.arc(0, 0, 15, 0, Math.PI * 2);
              ctx.fill();

              ctx.fillStyle = "#f39c12";
              ctx.beginPath();
              ctx.arc(0, 0, 10, 0, Math.PI * 2);
              ctx.fill();

              ctx.fillStyle = "#000";
              ctx.font = "bold 14px Arial";
              ctx.textAlign = "center";
              ctx.textBaseline = "middle";
              ctx.fillText("C", 0, 0);

              ctx.restore();
            }
          }

          // –§–∏–Ω–∏—à
          ctx.fillStyle = "#e74c3c";
          ctx.fillRect(
            this.finish.x,
            this.finish.y,
            this.finish.width,
            this.finish.height
          );
          ctx.fillStyle = "#ffffff";
          ctx.font = "bold 16px Arial";
          ctx.textAlign = "center";
          ctx.textBaseline = "middle";
          ctx.fillText(
            "FINISH",
            this.finish.x + this.finish.width / 2,
            this.finish.y + this.finish.height / 2
          );

          // –ò–≥—Ä–æ–∫
          ctx.save();

          if (!player.facingRight) {
            ctx.translate(player.x + player.width / 2, 0);
            ctx.scale(-1, 1);
            ctx.translate(-(player.x + player.width / 2), 0);
          }

          ctx.fillStyle = "#3498db";
          ctx.fillRect(player.x, player.y, player.width, player.height);

          // –ì–æ–ª–æ–≤–∞
          ctx.fillStyle = "#2980b9";
          ctx.beginPath();
          ctx.arc(
            player.x + player.width / 2,
            player.y + 15,
            12,
            0,
            Math.PI * 2
          );
          ctx.fill();

          // –ì–ª–∞–∑–∞
          ctx.fillStyle = "#fff";
          ctx.beginPath();
          ctx.arc(
            player.x + player.width / 2 - 5,
            player.y + 12,
            3,
            0,
            Math.PI * 2
          );
          ctx.arc(
            player.x + player.width / 2 + 5,
            player.y + 12,
            3,
            0,
            Math.PI * 2
          );
          ctx.fill();

          // –¢–µ–ª–æ
          ctx.fillStyle = "#2980b9";
          ctx.fillRect(
            player.x + 5,
            player.y + 25,
            player.width - 10,
            player.height - 30
          );

          // –ù–æ–≥–∏
          ctx.fillStyle = "#21618c";
          const legOffset = Math.sin(Date.now() / 100) * 3;
          ctx.fillRect(player.x + 8, player.y + player.height - 15, 8, 15);
          ctx.fillRect(
            player.x + player.width - 16,
            player.y + player.height - 15 + legOffset,
            8,
            15
          );

          ctx.restore();

          // UI –ø–æ–≤–µ—Ä—Ö
          ctx.fillStyle = "white";
          ctx.font = "bold 16px Arial";
          ctx.textAlign = "left";
          ctx.textBaseline = "top";
          ctx.fillText(
            `–ú–æ–Ω–µ—Ç—ã: ${this.coinsCollected}/${this.totalCoins}`,
            10,
            10
          );
          ctx.fillText(`–£—Ä–æ–≤–µ–Ω—å: ${this.currentLevel}`, 10, 35);
          ctx.fillText(`–°—á–µ—Ç: ${this.score}`, 10, 60);
        }
      }

      // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      window.addEventListener("load", () => {
        console.log("–ó–∞–≥—Ä—É–∂–∞–µ–º –∏–≥—Ä—É...");
        window.game = new SimpleGame();

        // –¢–µ—Å—Ç
        setTimeout(() => {
          console.log("–ì–æ—Ç–æ–≤–æ! –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: A/D - –¥–≤–∏–∂–µ–Ω–∏–µ, W/Space - –ø—Ä—ã–∂–æ–∫");
          console.log(
            "–í—Å–µ–≥–æ 3 —É—Ä–æ–≤–Ω—è. –°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ –º–æ–Ω–µ—Ç—ã —á—Ç–æ–±—ã –ø—Ä–æ–π—Ç–∏ —É—Ä–æ–≤–µ–Ω—å!"
          );
        }, 1000);
      });
    </script>
  </body>
</html>
